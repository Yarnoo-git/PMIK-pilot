# Q75, Q76 데이터 구조 분석 및 권장사항

## 현재 상황

### 1. pmik_eos.xlsx의 현재 구조
- **Q75**: 12개 하위 문항으로 분할 (75.01 ~ 75.12)
- **Q76**: 12개 하위 문항으로 분할 (76.01 ~ 76.12)

각 하위 문항은:
- **문항**: 동일한 질문 텍스트 (예: "귀하로 하여금 업무에 몰입하게 하는 요인 중에 가장 중요한 요인은 무엇입니까?")
- **선택(보기)**: 각 선택지 텍스트 (예: 75.01 → "회사의 성장 가능성", 75.02 → "조직문화 및 분위기")

### 2. pmik_raw_data의 응답 형식
```
r075: "4 11 10"  (4번, 11번, 10번 선택지를 선택)
r076: "1 6 7"    (1번, 6번, 7번 선택지를 선택)
```

응답자는 3개의 선택지 번호를 공백으로 구분하여 입력

---

## 두 가지 구조 비교

### 옵션 A: 현재 구조 (75.01 ~ 75.12, 76.01 ~ 76.12)

**장점:**
- 각 선택지가 독립적인 행으로 존재하여 선택지 텍스트 관리가 용이
- 선택지 추가/수정 시 행만 추가/수정하면 됨
- 선택지별 메타데이터(대분류, 중분류 등) 관리 가능

**단점:**
- 원본 문항 번호가 소수점으로 표시되어 직관적이지 않음 (75.08999... 같은 부동소수점 오류 발생)
- 데이터베이스 쿼리 시 `No. BETWEEN 75.0 AND 75.99` 같은 범위 검색 필요
- pmik_raw_data의 r075, r076과 직접적인 매핑이 어려움
  - r075 = "4 11 10" → 75.04, 75.11, 75.10을 의미하는지 혼란
- 99개 문항 체계에서 75, 76번이 누락되어 보임

**데이터 일관성 문제:**
- Excel에서 75.08은 `75.0899999999999`로 저장됨 (부동소수점 정밀도 문제)
- 이는 데이터 처리 시 버그의 원인이 될 수 있음

---

### 옵션 B: 단일 문항 구조 (75, 76 + 선택지에 번호 추가)

**구조:**
```
No.   문항                                             선택(보기)
75    귀하로 하여금 업무에 몰입하게 하는...            ① 회사의 성장 가능성
                                                      ② 조직문화 및 분위기
                                                      ③ 높은 금전적 보상 수준
                                                      ...
                                                      ⑫ 경력 개발
76    귀하로 하여금 업무 몰입을 저해하는...            ① 경쟁사보다 낮은 보상 수준
                                                      ② 자기 성장의 기회 부족
                                                      ...
                                                      ⑫ 기타
```

**장점:**
- 문항 번호가 명확하고 직관적 (1~77번 완전한 시퀀스)
- pmik_raw_data의 r075, r076과 직접 매핑 가능
  - r075 = "4 11 10" → 4번, 11번, 10번 선택지
- 다른 문항들(1~74, 77)과 동일한 형식으로 일관성 유지
- 부동소수점 오류 없음
- 데이터 분석 시 직관적 (75번 문항에 대한 응답은 r075 컬럼)

**단점:**
- 선택지가 긴 텍스트로 저장되어 한 셀에 12개 선택지 포함
- 선택지별 메타데이터를 별도로 관리할 수 없음
- 선택지 수정 시 전체 텍스트를 수정해야 함

---

## 권장사항: **옵션 B (단일 문항 구조)**

### 이유:

1. **데이터 일관성**
   - pmik_raw_data의 응답 형식(r075, r076)과 완벽하게 매칭
   - 75번, 76번 문항이 명확하게 존재하여 1~77번 완전한 문항 시퀀스 유지

2. **분석 용이성**
   - 응답 데이터 해석이 직관적: r075 = "4 11 10" → Q75의 4, 11, 10번 선택지
   - SQL 쿼리 단순화: `WHERE "No." = 75` (범위 검색 불필요)

3. **유지보수**
   - 부동소수점 오류 방지 (75.08999... 같은 문제 없음)
   - 다른 77개 문항과 동일한 구조로 코드 재사용 가능

4. **EOS 설문 표준**
   - 대부분의 설문조사 시스템에서 객관식 문항은 하나의 문항으로 관리
   - 선택지는 문항의 속성으로 저장

### 구현 방법:

```python
# 75번 문항 예시
{
    'No.': 75.0,
    '대분류': '기타',
    '중분류': '동기부여 및 저해 요인',
    '소분류': '동기부여 요인',
    '문항': '귀하로 하여금 업무에 몰입하게 하는 요인 중에 가장 중요한 요인은 무엇입니까?\n다음 보기 중 3가지를 선택하여 주십시오',
    '선택(보기)': '''① 회사의 성장 가능성
② 조직문화 및 분위기
③ 높은 금전적 보상 수준
④ 충분한 복리후생 지원
⑤ 다양한 업무 경험
⑥ 교육 프로그램
⑦ 적절한 권한위임
⑧ 성과, 능력에 따른 평가
⑨ 상사의 리더십
⑩ 일과 개인생활의 조화
⑪ 근무 환경에 대한 만족
⑫ 경력 개발''',
    '비고': '복수선택 (3개)'
}
```

### 선택지 번호 매핑 테이블 (선택적)

만약 선택지별 상세 정보가 필요하다면, 별도의 테이블을 생성할 수 있습니다:

```sql
CREATE TABLE pmik_eos_options (
    question_no INTEGER,
    option_no INTEGER,
    option_text TEXT,
    PRIMARY KEY (question_no, option_no)
);

-- 예시 데이터
INSERT INTO pmik_eos_options VALUES
    (75, 1, '회사의 성장 가능성'),
    (75, 2, '조직문화 및 분위기'),
    ...
    (76, 1, '경쟁사보다 낮은 보상 수준'),
    ...
```

이렇게 하면:
- pmik_eos: 문항 정보 (75, 76번 각 1행)
- pmik_eos_options: 선택지 정보 (75번 12행, 76번 12행)
- pmik_raw_data: 응답 데이터 (r075, r076)

---

## 결론

**권장: 옵션 B (75, 76번을 단일 문항으로 관리)**

이 구조가 데이터 일관성, 분석 용이성, 유지보수 측면에서 더 우수합니다. 현재 pmik_raw_data의 r075, r076 응답 형식과 완벽하게 매칭되며, 부동소수점 오류 같은 기술적 문제도 방지할 수 있습니다.

만약 선택지별 상세 정보가 필요하다면 별도의 `pmik_eos_options` 테이블을 추가로 생성하는 것을 권장합니다.
